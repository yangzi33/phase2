phase1 & 2 code without UI.
